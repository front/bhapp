<html>
<head>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>	
	<script type="text/javascript" src="photoswipe/lib/klass.min.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.js"></script>
	<script type="text/javascript" src="photoswipe/code.photoswipe-3.0.4.min.js"></script>


	<link href="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.css" rel="stylesheet" />
	<link href="http://www.photoswipe.com/latest/examples/jquery-mobile.css" type="text/css" rel="stylesheet" />
	<link href="http://www.photoswipe.com/latest/photoswipe.css" type="text/css" rel="stylesheet" />




	<script type="text/javascript">

		$("#Search-page").live("pageinit",function(event){
		
			$("form").submit(function(){
			var q = $("#search").val();
			var SERVICE_URI = 'http://barnehage.vps4.front.no/api/rest/search_node/retrieve.json';
			
			
			var request = $.ajax({
				type:"GET",
				url: SERVICE_URI,
				data:"keys=" + q,
				dataType: "json"
				});
						
			// SUCCESS
			request.done(function(msg){
				console.log(msg);
				$.each(msg,function(){ 
					$("div#Result ul").append("<li class='ui-li ui-li-static ui-body-c'><p class='ui-li-aside'>" + this.type + "</p><a href='" + this.link + "'><h3>" + this.title + "</h3></a><p>" + this.snippet + "</p></li>");	
					});
				});
				
			// FAILURE
			request.fail(function(jqXHR, textStatus){
				alert("Search failed: " + textStatus);
				});
			return false;
			});
		
		});
	</script>



</head>
<body>
	<div data-role="page" data-add-back-btn="true" id="Search-page">
		<div data-role="header">
			<h1>Search</h1>
			<form action="" method="get" class="ui-body ui-body-a ui-corner-all">
				<div data-role="fieldcontain">
					<input type="search" name="search" id="search" value="" />
					<button type="submit" name="submit">Search</input>
				</div>
			</form>
		</div>
		<div data-role="content">
			<div id="Result">
				<ul data-role="listview" data-theme="c">
					<!-- Results build with jquery -->
				</ul>
			</div>
		</div>
	</div> 
</body>

</html>